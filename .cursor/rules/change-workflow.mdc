---
description: Enforces dependency-aware changes across the codebase
alwaysApply: true
---

# Change Workflow

Every code change MUST follow this protocol:

1. **Read first** — Understand the file and its role before editing
2. **Trace imports** — Identify everything the changed file imports
3. **Trace consumers** — Identify every file that imports from the changed file
4. **Assess impact** — Determine if the change affects any interface, signature, type, or behavior used by other modules
5. **Update all affected files** — If dependents are impacted, update them in the same change
6. **Verify consistency** — Confirm types, signatures, and data flow are consistent across the full chain

**Never change a file in isolation.** A change is incomplete until all dependent modules are verified and updated.

## Dependency Reference

```
src/cli.ts → src/server.ts (startServer)
             src/dashboard.ts (createManagementServer)
             src/types.ts

src/server.ts → src/template.ts, src/store.ts, src/watcher.ts, src/types.ts

src/dashboard.ts → src/manager.ts → src/server.ts, src/project.ts, src/types.ts
                   src/project.ts → src/types.ts
                   src/schema/sql.ts → src/types.ts
                   src/schema/openapi.ts → src/types.ts
                   src/types.ts

src/template.ts → src/types.ts
src/store.ts → src/types.ts
```

- Changing `types.ts` → check ALL modules
- Changing `server.ts` → check `cli.ts`, `manager.ts`
- Changing `manager.ts` → check `dashboard.ts`
- Changing `project.ts` → check `manager.ts`, `dashboard.ts`
- Changing `dashboard.ts` → check `cli.ts`
- Changing `template.ts` or `store.ts` → check `server.ts`
- Changing `schema/*.ts` → check `dashboard.ts`

## Expansion Policy

- Always explore the existing codebase before adding anything new
- Only create new files or abstractions when genuinely required
- Prefer extending existing modules over introducing new ones
- Remove dead code when refactoring — leave no unused imports or functions
